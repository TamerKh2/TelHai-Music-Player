<Window x:Class="TelHai.DotNet.PlayerProject.Views.SongDetailsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Song Details (MVVM)" Height="650" Width="980"
        Background="#222" Foreground="White"
        WindowStartupLocation="CenterOwner">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="{Binding HeaderText}"
                   FontSize="18" FontWeight="Bold"
                   Margin="0,0,0,10"/>

        <!-- Search bar -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Search iTunes:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <TextBox Width="320"
                     Text="{Binding SearchTerm, UpdateSourceTrigger=PropertyChanged}"
                     Margin="0,0,8,0"/>
            <Button Content="Search" Width="110" Command="{Binding SearchCommand}" Margin="0,0,8,0"/>
            <Button Content="Cancel" Width="110" Command="{Binding CancelCommand}" Margin="0,0,14,0"/>

            <Button Content="Save Song JSON" Width="140" Command="{Binding SaveSongCommand}" Margin="0,0,8,0"/>
            <Button Content="Load Song JSON" Width="140" Command="{Binding LoadSongCommand}"/>
        </StackPanel>

        <!-- Main content -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1.2*"/>
                <ColumnDefinition Width="1.5*"/>
            </Grid.ColumnDefinitions>

            <!-- LEFT: Track details + applied metadata + images -->
            <Border Grid.Column="0" Background="#2B2B2B" CornerRadius="8" Padding="12" Margin="0,0,10,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Song Info" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>

                        <TextBlock Text="Artist:" Foreground="#AAA"/>
                        <TextBox Text="{Binding TrackArtist, UpdateSourceTrigger=PropertyChanged}" Margin="0,5,0,10"/>

                        <TextBlock Text="Title:" Foreground="#AAA"/>
                        <TextBox Text="{Binding TrackTitle, UpdateSourceTrigger=PropertyChanged}" Margin="0,5,0,10"/>

                        <TextBlock Text="Duration (min):" Foreground="#AAA"/>
                        <TextBox Text="{Binding TrackDurationText, UpdateSourceTrigger=PropertyChanged}" Margin="0,5,0,10"/>

                        <Separator Margin="0,10,0,10"/>

                        <TextBlock Text="Metadata (from iTunes / manual)" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>

                        <TextBlock Text="Album:" Foreground="#AAA"/>
                        <TextBox Text="{Binding AlbumName, UpdateSourceTrigger=PropertyChanged}" Margin="0,5,0,10"/>

                        <TextBlock Text="Preview URL:" Foreground="#AAA"/>
                        <StackPanel Orientation="Horizontal" Margin="0,5,0,10">
                            <TextBox Text="{Binding PreviewUrl}" IsReadOnly="True" Width="340" Margin="0,0,8,0"/>
                            <Button Content="Open" Width="80" Command="{Binding OpenPreviewCommand}"/>
                        </StackPanel>

                        <TextBlock Text="Artwork:" Foreground="#AAA"/>
                        <Border Background="#333" CornerRadius="8" Padding="8" Margin="0,5,0,10">
                            <Image Source="{Binding ArtworkImage}" Height="160" Stretch="Uniform"/>
                        </Border>

                        <Separator Margin="0,10,0,10"/>

                        <TextBlock Text="Images (Add/Remove)" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>

                        <ListBox ItemsSource="{Binding Images}"
                                 SelectedItem="{Binding SelectedImage}"
                                 Background="#333" Foreground="White"
                                 Height="140"/>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                            <Button Content="Add Image" Width="120" Margin="0,0,8,0" Command="{Binding AddImageCommand}"/>
                            <Button Content="Remove" Width="120" Command="{Binding RemoveImageCommand}"/>
                        </StackPanel>

                        <TextBlock Text="{Binding StatusText}" Foreground="#AAA" Margin="0,12,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- RIGHT: Search results -->
            <Border Grid.Column="1" Background="#2B2B2B" CornerRadius="8" Padding="12">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="iTunes Results" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>

                    <ListBox Grid.Row="1"
                             ItemsSource="{Binding Results}"
                             SelectedItem="{Binding SelectedResult}"
                             Background="#333"
                             Foreground="White"/>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                        <Button Content="Apply Selected"
                                Width="140"
                                Command="{Binding ApplySelectedCommand}"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
